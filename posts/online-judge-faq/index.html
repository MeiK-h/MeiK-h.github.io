<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>MeiK&#39;s blog  | OnlineJudge 评测原理与常见问题解答</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="generator" content="Hugo 0.58.3" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
    
      <link href="/dist/css/app.d98f2eb6bcd1eaedb7edf166bd16af26.css" rel="stylesheet">
    

    

    
      
    

    
    
    <meta property="og:title" content="OnlineJudge 评测原理与常见问题解答" />
<meta property="og:description" content="总会有人在群里问：“这个程序在我本地是正确的，但是提交到 OJ 上错误了”或者“本地 AC 但是提交 WA”。今天我来给大家讲解一下 OJ 的评测原理，以及对一些出现频率较高的问题进行解答。

建议在看本文之前先看一下这篇经典的文章：《提问的智慧》。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://meik2333.com/posts/online-judge-faq/" />
<meta property="article:published_time" content="2018-12-14T11:26:14+00:00" />
<meta property="article:modified_time" content="2018-12-14T11:26:14+00:00" />
<meta itemprop="name" content="OnlineJudge 评测原理与常见问题解答">
<meta itemprop="description" content="总会有人在群里问：“这个程序在我本地是正确的，但是提交到 OJ 上错误了”或者“本地 AC 但是提交 WA”。今天我来给大家讲解一下 OJ 的评测原理，以及对一些出现频率较高的问题进行解答。

建议在看本文之前先看一下这篇经典的文章：《提问的智慧》。">


<meta itemprop="datePublished" content="2018-12-14T11:26:14&#43;00:00" />
<meta itemprop="dateModified" content="2018-12-14T11:26:14&#43;00:00" />
<meta itemprop="wordCount" content="155">



<meta itemprop="keywords" content="OnlineJudge," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="OnlineJudge 评测原理与常见问题解答"/>
<meta name="twitter:description" content="总会有人在群里问：“这个程序在我本地是正确的，但是提交到 OJ 上错误了”或者“本地 AC 但是提交 WA”。今天我来给大家讲解一下 OJ 的评测原理，以及对一些出现频率较高的问题进行解答。

建议在看本文之前先看一下这篇经典的文章：《提问的智慧》。"/>

  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="https://meik2333.com" class="f3 fw2 hover-white no-underline white-90 dib">
      MeiK&#39;s blog
    </a>
    <div class="flex-l items-center">
      

      
      











    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">

    <header class="mt4 w-100">
      <p class="f6 b helvetica tracked">
          
        POSTS
      </p>
      <h1 class="f1 athelas mb1">OnlineJudge 评测原理与常见问题解答</h1>
      
      
      <time class="f6 mv4 dib tracked" datetime="2018-12-14T11:26:14Z">December 14, 2018</time>
      
      
    </header>

    <section class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><p>总会有人在群里问：“这个程序在我本地是正确的，但是提交到 OJ 上错误了”或者“本地 AC 但是提交 WA”。今天我来给大家讲解一下 OJ 的评测原理，以及对一些出现频率较高的问题进行解答。</p>

<p>建议在看本文之前先看一下这篇经典的文章：<a href="/2018/02/24/（转）提问的智慧/">《提问的智慧》</a>。</p>

<h2 id="onlinejudge-的评测原理">OnlineJudge 的评测原理</h2>

<p>OJ 评测一个用户代码大概分为以下几步：</p>

<ol>
<li>编译代码</li>
<li>重定向输入输出，运行用户程序</li>
<li>对比用户程序输出和标准答案</li>
</ol>

<h3 id="资源限制">资源限制</h3>

<p>如果用户不小心提交了死循环的话，我们肯定不能一直等着它结束，因此要使用某种方式来限制用户程序占用的资源。</p>

<p>需要限制的主要是：占用时间、占用内存、输出文件大小等。</p>

<h3 id="权限限制">权限限制</h3>

<p>在服务器上运行用户提交的代码是很危险的，如果用户提交的一个 <code>system('rm -rf /')</code> 被执行了，那就瞬间爆炸了。或者通过 <code>#include</code> 来引用一些密码文件，然后在编译信息中有服务器密码等信息，也会导致相当危险的情况。</p>

<p>因此对用户提交的程序的运行权限要做严格的控制，常用的手段有创建专门用于评测的用户、使用 Docker 进行限制、限制 <code>syscall</code> 等。</p>

<h3 id="输入输出">输入输出</h3>

<p>有些 OJ 要求用户手动打开文件读取，并将输出写入文件。但大部分 OJ （包括 SDUTOJ）的做法都是通过重定向输入输出流，来让程序可以从 <code>stdin</code> 读、输出到 <code>stdout</code>，这样用户就不需要使用文件读写等操作了。</p>

<h3 id="对比答案">对比答案</h3>

<p>这里就要祭出我当年画的 OJ 评测流程图了。</p>

<p><img src="/images/online-judge-faq/oj.png" alt="" />（虽然有 csdn 的水印，但是是我自己画的图）</p>

<h3 id="完整实现">完整实现</h3>

<p><a href="https://github.com/MeiK2333/JudgeLight">这里</a>是一个 OJ 评测姬核心的完整实现，关键注释齐全，可以用作参考。</p>

<h2 id="常见问题解答">常见问题解答</h2>

<p>首先，所有的问题其实都是：</p>

<p><img src="/images/online-judge-faq/ojgg.png" alt="" /></p>

<p>用户是不可能出问题的，所有的问题都是 OJ 的问题。下面的问题解答针对的是某个不知名的平行世界，在那个世界里：</p>

<p><img src="/images/online-judge-faq/yougg.png" alt="" /></p>

<h3 id="为什么我本地-ac-提交却-wa-了">为什么我本地 AC，提交却 WA 了</h3>

<p>首先要明确，没有本地 AC 这种操作。如果你本地就能 AC，那么何必将代码提交到 OJ 上呢。</p>

<p>如果你说的是你的代码在你本地通过了测试数据的考验，但是提交到 OJ 却出错了：这是非常正常的。OJ 上给定的测试数据仅仅是其中一组数据，实际评测时会参照的可并不只有这一组数据。</p>

<p>当你发现本地通过测试而提交 WA 时，你应该做的是检查你的代码在不同的边缘数据时的表现，而不是去群里抱怨你“本地 AC”。</p>

<p>当然，有时候确实是题目或者数据出了问题，不过这个时候 OJ 和评测姬也是不背锅的。请找到对应题目的出题人，然后狠狠地把错误拍他脸上。</p>

<h3 id="为什么我本地-ac-提交却-ce-了">为什么我本地 AC，提交却 CE 了</h3>

<p>OJ 评测姬的系统环境是 Linux，因此如果你使用了某些平台专属的操作（比如 <code>#include &lt;Windows.h&gt;</code>）的话就会 GG。</p>

<p>当然， 80% 的可能是你的代码写的有问题，你本地能运行只是你的编译器帮你做了一点优化。</p>

<p>这里列举一些常见的错误：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>() {}  <span style="color:#75715e">// 错误！main 的返回值必须为 int
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() { <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>; }  <span style="color:#75715e">// 非零返回值的 main 函数可能让你的程序直接判错
</span><span style="color:#75715e"></span>
printf(<span style="color:#e6db74">&#34;%lf</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, ans);  <span style="color:#75715e">// 输出的时候没有 %lf 这种操作，请使用 %f
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">int</span> cnt; cout <span style="color:#f92672">&lt;&lt;</span> cnt <span style="color:#f92672">&lt;&lt;</span> endl;  <span style="color:#75715e">// 未初始化的变量的值是未定义的，也就是说，它可能是任何值
</span></code></pre></div>
<h3 id="为什么我的提交-se-了">为什么我的提交 SE 了</h3>

<p>SE（System Error）顾名思义是系统错误，这个错误一般和你的代码没啥关系。但是如果你发现你的某个代码只要提交就稳定 SE 的话，那么你最好检查一下你的代码里有没有非法字符。</p>

<h3 id="为什么我本地-wa-提交却-ac-了">为什么我本地 WA，提交却 AC 了</h3>

<p>如果你的代码中有 UB（undefined behavior，未定义行为）的话，那么你提交的程序可能返回任意结果。</p>

<p>常见的 UB：变量未初始化、访问越界数组、<code>func(a++, b++, a--)</code> 、除零、函数未写返回值等操作。</p>

<h3 id="道理我都懂但是我要怎么减少这些错误">道理我都懂但是我要怎么减少这些错误</h3>

<p>一句话：不要 xjb 乱写，加上看看课本，就能在绝大部分情况下避免这些神奇错误。</p>

<p>我在初学阶段，总是先看一遍书再敲代码，在运行之前就已经知道其运行过程与结果了。这并不是多么难的东西，你要知道，大部分情况下，你翻一下课本，能比去群里跪求大佬收获更多。</p>

<p>另外，如果你使用和 OJ 相近的环境，可以在一定程度上减少这些错误。关于如何配置环境，可以看我写的<a href="https://github.com/sdutacm/cpp-style-guide">《
C/C++ 代码风格指导》</a>，里面有配置环境的方法与一些敲代码的指导。</p><ul class="pa0">
  
   <li class="list">
     <a href="/tags/onlinejudge" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">OnlineJudge</a>
   </li>
  
</ul>
<div class="mt6">
      
      
      </div>
    </section>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://meik2333.com" >
    &copy; 2019 MeiK&#39;s blog
  </a>
    <div>










</div>
  </div>
</footer>

    

  <script src="/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
